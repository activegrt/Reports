let currentVideoId = 0;
const baseURL = "https://server10.masahub.cc/myfiless/id/";

// Attempt to load the video from multiple servers
function loadVideo() {
    const fileName = document.getElementById("fileName").value.trim();
    if (fileName) {
        currentVideoId = fileName;
        let videoLoaded = false;
        let currentServer = 10; // Starting with server 10

        // Function to check the video from the server
        function tryVideoFromServer(serverId) {
            const videoURL = `https://server${serverId}.masahub.cc/myfiless/id/${currentVideoId}.mp4`;
            fetch(videoURL, { method: 'HEAD' }) // Check if the video exists
                .then(response => {
                    if (response.ok) {
                        // If video exists, load it
                        document.getElementById("videoSource").src = videoURL;
                        document.getElementById("videoPlayer").load();
                        document.getElementById("videoPlayer").play();
                        videoLoaded = true;
                    } else if (serverId < 16 && !videoLoaded) {
                        // If the video is not found, try the next server
                        tryVideoFromServer(serverId + 1);
                    } else {
                        // If video is not found in any server, show a message
                        if (!videoLoaded) {
                            document.getElementById("videoSource").src = "";
                            alert("Video not found.");
                        }
                    }
                })
                .catch(() => {
                    // If there was an error with the request, try the next server
                    if (serverId < 16 && !videoLoaded) {
                        tryVideoFromServer(serverId + 1);
                    }
                });
        }

        tryVideoFromServer(currentServer); // Start checking from server 10
    } else {
        alert("Please enter a valid video file name.");
    }
}

// Change video to next or previous
function changeVideo(direction) {
    if (direction === 'next') {
        currentVideoId++;
    } else if (direction === 'prev' && currentVideoId > 1) {
        currentVideoId--;
    }
    document.getElementById("fileName").value = currentVideoId;
    loadVideo();
}

// Download the video
function downloadVideo() {
    const videoURL = baseURL + currentVideoId + ".mp4";
    const a = document.createElement("a");
    a.href = videoURL;
    a.download = currentVideoId + ".mp4";
    a.click();
}
