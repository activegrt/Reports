<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    .table-container {
      width: 100%;
      max-height: 600px;
      overflow-y: auto;
      border: 1px solid #ccc;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 8px 12px;
      border: 1px solid #ccc;
      text-align: left;
    }
    thead th {
      position: sticky;
      top: 0;
      background: #f1f1f1;
      cursor: pointer;
    }
    th.sort-asc::after {
      content: " â–²";
    }
    th.sort-desc::after {
      content: " â–¼";
    }
    .expand-btn {
      color: blue;
      cursor: pointer;
      text-decoration: underline;
    }
    .detail-row {
      display: none;
      background-color: #f9f9f9;
    }
    .detail-content {
      padding: 10px;
      font-size: 14px;
    }
	.detail-content {
	  display: grid;
	  grid-template-columns: repeat(3, 1fr);
	  gap: 12px;
	  padding: 16px;
	  font-size: 14px;
	  border-radius: 8px;
	  background: #ffffff;
	  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
	}

	.detail-box {
	  background: #f5faff;
	  border: 1px solid #ddeeff;
	  padding: 10px;
	  border-radius: 6px;
	}

	.detail-box strong {
	  display: block;
	  color: #333;
	  font-weight: bold;
	  margin-bottom: 4px;
	}

	.positive {
	  color: green;
	}

	.negative {
	  color: red;
	}
  </style>
</head>
<body>

<h2>Holdings Summary</h2>
<div class="table-container">
  <table id="holdingsTable">
    <thead>
      <tr>
        <th data-index="0">#</th>
        <th data-index="1">Symbol</th>
        <th data-index="2">Exchange</th>
        <th data-index="3">CMP</th>
        <th data-index="4">Change</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1</td>
        <td>ALEMBICLTD</td>
        <td>NSE</td>
        <td>117.91</td>
        <td>ðŸš€ 1%</td>
        <td><span class="expand-btn" onclick="toggleDetails(this)">Show Details</span></td>
      </tr>
      <tr class="detail-row">
        <td colspan="6">
          <div class="detail-content">
			  <div class="detail-box">
				<strong>Quantity</strong>100<br>
				<strong>Entry</strong>117.23<br>
				<strong>Target</strong>123.34
			  </div>
			  <div class="detail-box">
				<strong>Investment</strong>â‚¹11,723<br>
				<strong>Current</strong>â‚¹11,791<br>
				<strong>Profit/Loss</strong><span class="positive">â‚¹68</span>
			  </div>
			  <div class="detail-box">
				<strong>Dividend</strong>2.03% on 2025-08-05<br>
				<strong>Rank</strong>917<br>
				<strong>Revenue</strong>â‚¹221 cr
			  </div>
			</div>
        </td>
      </tr>
      <tr>
        <td>2</td>
        <td>AVADHSUGAR</td>
        <td>NSE</td>
        <td>469.95</td>
        <td>ðŸ”¥ -8%</td>
        <td><span class="expand-btn" onclick="toggleDetails(this)">Show Details</span></td>
      </tr>
      <tr class="detail-row">
        <td colspan="6">
          <div class="detail-content">
            Quantity: 20 | Entry: 512.14 | Target: 0 <br>
            Investment: â‚¹10,243 | Current: â‚¹9,399 | Profit/Loss: -â‚¹844<br>
            Dividend: 2.08% on 2025-07-16 | Rank: 1273 | Revenue: â‚¹2,635 cr
          </div>
        </td>
      </tr>
      <tr>
        <td>3</td>
        <td>fdfd</td>
        <td>NSE</td>
        <td>49.95</td>
        <td>ðŸ”¥ -3%</td>
        <td><span class="expand-btn" onclick="toggleDetails(this)">Show Details</span></td>
      </tr>
      <tr class="detail-row"></tr>
    </tbody>
  </table>
</div>

<script>
  // Multi-level sorting state
  let sortState = {};

  document.querySelectorAll('#holdingsTable thead th').forEach(th => {
    if (th.dataset.index) {
      th.addEventListener('click', () => sortTable(parseInt(th.dataset.index)));
    }
  });

  function sortTable(columnIndex) {
    const table = document.getElementById('holdingsTable');
    const tbody = table.querySelector('tbody');
    const allRows = Array.from(tbody.querySelectorAll('tr'));
	const rows = [];

	for (let i = 0; i < allRows.length; i++) {
	  const row = allRows[i];
	  if (!row.classList.contains('detail-row')) {
		const detailRow = allRows[i + 1] && allRows[i + 1].classList.contains('detail-row') ? allRows[i + 1] : null;
		rows.push({ row, detail: detailRow });
	  }
	}

    const header = table.querySelectorAll('th')[columnIndex];
    const currentOrder = sortState[columnIndex] || 'none';
    const newOrder = currentOrder === 'asc' ? 'desc' : 'asc';
    sortState = { [columnIndex]: newOrder };

    // Reset header classes
    table.querySelectorAll('th').forEach(th => th.classList.remove('sort-asc', 'sort-desc'));
    header.classList.add(newOrder === 'asc' ? 'sort-asc' : 'sort-desc');

    // Sorting logic
    rows.sort((a, b) => {
      const valA = a.row.children[columnIndex].innerText.trim().replace(/[^0-9a-zA-Z.-]/g, '');
      const valB = b.row.children[columnIndex].innerText.trim().replace(/[^0-9a-zA-Z.-]/g, '');
      const numA = parseFloat(valA);
      const numB = parseFloat(valB);
      const isNumeric = !isNaN(numA) && !isNaN(numB);

      if (isNumeric) {
        return newOrder === 'asc' ? numA - numB : numB - numA;
      } else {
        return newOrder === 'asc'
          ? valA.localeCompare(valB)
          : valB.localeCompare(valA);
      }
    });

    // Rebuild tbody
    tbody.innerHTML = '';
    rows.forEach(({ row, detail }) => {
      tbody.appendChild(row);
      tbody.appendChild(detail);
    });
  }

  function toggleDetails(button) {
    const row = button.closest('tr');
    const detailRow = row.nextElementSibling;
    const visible = detailRow.style.display === 'table-row';
    detailRow.style.display = visible ? 'none' : 'table-row';
    button.textContent = visible ? 'Show Details' : 'Hide Details';
  }
</script>

</body>
</html>
